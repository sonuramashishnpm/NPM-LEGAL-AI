<!DOCTYPE html>
<html lang="en">
<head>
  <title>NPM Legal AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{{ url_for('static', filename='NPMaistyle.css') }}">
</head>

<body>

<header class="header">NPM Legal AI</header>

<video autoplay muted loop id="background-video">
  <source src="https://npmexplorer.netlify.app/NPM%20ai%20backgrond%20video.mp4">
</video>
<div id="video-overlay"></div>

<main class="container">

  <h2>Ask Anything</h2>
  <div id="chat-box" style="height: 400px; overflow-y: auto; padding: 10px; border: 1px solid #ccc; background: rgba(0,0,0,0.5); color: white; white-space: pre-wrap;">
  </div>

  <div class="card">

    <label>Upload PDF</label>
    <input type="file" id="pdf_file" accept=".pdf">

    <label>Upload Image</label>
    <input type="file" id="image_file" accept=".png,.jpg,.jpeg">
    
    <label>Knowledge Base Name</label>
    <input id="db" placeholder="Knowledge Base Name">

    <label>Your Question</label>
    <input id="question" placeholder="Your question">

    <button onclick="ask()">Send</button>

  </div>

</main>
<script>
function appendMessage(role, text) {
  const chatBox = document.getElementById("chat-box");
  const msgDiv = document.createElement("div");
  msgDiv.style.marginBottom = "15px";
  msgDiv.innerHTML = `<strong>${role}:</strong> ${text}`;
  chatBox.appendChild(msgDiv);
  chatBox.scrollTop = chatBox.scrollHeight; 
}
  
async function ask() {
  const fd = new FormData();

  const pdf = pdf_file.files[0];
  const img = image_file.files[0];

  let sources = [pdf, img].filter(x => x);

  if (sources.length === 0) {
    alert("Please provide ONE source");
    return;
  }

  if (sources.length > 1) {
    alert("Please provide ONLY ONE source");
    return;
  }

  if (!db.value || !question.value) {
    alert("DB name and question are required");
    return;
  }

  fd.append("DB_PATH", db.value);
  fd.append("query", question.value);

  appendMessage("You", question.value);
    inputField.value = ""; 

  if (pdf) fd.append("file", pdf);
  else if (img) fd.append("file", img);

  const res = await fetch("/ask", {
    method: "POST",
    body: fd
  });

  const j = await res.json();

  appendMessage("AI", j.response);

}
</script>

</body>
</html>








